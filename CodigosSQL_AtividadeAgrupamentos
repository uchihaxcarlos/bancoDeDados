Atividades de Agrupamento, Sub consulta e GitHub.

Exercícios de Agrupamento:

1. Agrupe os dependentes por tipo de relação, mostrando somente o atributo
relação.
SELECT RELACAO FROM DEPENDENTE
group by RELACAO

2. Agrupe os dependentes por sexo mostrando somente o atributo sexo.
SELECT SEXO FROM DEPENDENTE
group by SEXO

3. Mostre a quantidade de dependentes por sexo
SELECT SEXO,COUNT(*)
FROM DEPENDENTE
group by SEXO

4. Mostre o valor do maior salário dos empregados
select avg(salario) as med_salario
from empregado

5. Mostre o valor do menor salário dos empregados
SELECT MIN(salario) AS salario
FROM empregado

6. Mostre a soma total de todos os salários dos empregados
SELECT SUM(salario) AS salario
FROM empregado

7. Mostre a soma total dos salários dos empregados por departamento mostrando o código do departamento e os valores para cada um.
SELECT DEPTO,SUM(SALARIO) FROM EMPREGADO
GROUP BY DEPTO

8. Mostre a média dos salários, a soma dos salários, o maior salário, o menor salário, e o desvio padrão dos salários.
SELECT depto,AVG(salario),SUM(salario),MAX(salario),MIN(salario),STDDEV(salario) FROM Empregado
GROUP BY depto


Exercícios de Agrupamento com Junção

1. Mostre o nome do empregado e a quantidade de dependentes que cada um possui.
SELECT nome, COUNT(dependente.nome_dependente)
FROM empregado
LEFT JOIN dependente
ON nome = dependente.nome_dependente
GROUP BY nome

2. Mostre o nome do empregado a quantidade de projetos em que cada empregado está relacionado.
SELECT NOME,COUNT(EMPREGADO_PROJETO.NUMERO_PROJETO) FROM EMPREGADO
INNER JOIN EMPREGADO_PROJETO ON (EMPREGADO_PROJETO.RG_EMPREGADO = EMPREGADO.RG)
GROUP BY NOME,RG_EMPREGADO

3. Para cada empregado, mostre seu nome e a soma total da quantidade de horas alocadas a projetos na qual é participante. o Resultado deve ser apresentado em ordem decrescente.
SELECT NOME,SUM(EMPREGADO_PROJETO.HORAS) AS DURACAO FROM EMPREGADO
INNER JOIN EMPREGADO_PROJETO ON (EMPREGADO_PROJETO.RG_EMPREGADO = EMPREGADO.RG)
GROUP BY NOME,RG_EMPREGADO
ORDER BY DURACAO DESC

4. Mostre o número do departamento e a quantidade de empregados alocados a cada departamento (considere somente departamentos que possuem empregados alocados).
SELECT NUMERO AS NUMERO_PROJETO , COUNT(EMPREGADO_PROJETO.RG_EMPREGADO) AS QT_PROJETOS FROM DEPARTAMENTO
INNER JOIN DEPARTAMENTO_PROJETO ON (DEPARTAMENTO_PROJETO.NUMERO_DEPTO = DEPARTAMENTO.NUMERO)
INNER JOIN EMPREGADO_PROJETO ON (EMPREGADO_PROJETO.NUMERO_PROJETO = DEPARTAMENTO_PROJETO.NUMERO_PROJETO)
GROUP BY NUMERO

5. Mostre o nome do departamento e a quantidade de funcionários alocados a cada departamento, somente nos departamento onde a quantidade de funcionários é maior ou igual a 3.
SELECT DEPARTAMENTO.NOME AS Departamento,COUNT(EMPREGADO.RG) AS Qtd_empregados FROM DEPARTAMENTO
INNER JOIN EMPREGADO ON (EMPREGADO.RG_SUPERVISOR = DEPARTAMENTO.RG_GERENTE)
GROUP BY Departamento
HAVING COUNT(EMPREGADO.RG) >= 3

6. Mostre o nome do departamento e a soma total dos salários dos empregados por departamento, somente para departamentos onde a soma é maior que 6000.
SELECT DEPARTAMENTO.NOME AS Departamento,SUM(EMPREGADO.SALARIO) AS SomaSalario FROM DEPARTAMENTO
INNER JOIN EMPREGADO ON (EMPREGADO.RG_SUPERVISOR = DEPARTAMENTO.RG_GERENTE)
GROUP BY Departamento
HAVING SUM(EMPREGADO.SALARIO) > 6000
